<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CSR Decoder</title>
<script src="https://cdn.jsdelivr.net/npm/jsrsasign"></script>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  textarea { width: 100%; height: 200px; font-family: monospace; }
  pre { background: #f0f0f0; padding: 10px; white-space: pre-wrap; }
  button { padding: 10px 20px; margin-top: 10px; }
</style>
</head>
<body>
<h1>Certificate Signing Request (CSR) Decoder</h1>
<p>Paste your CSR below (PEM format including headers):</p>
<textarea id="csrInput" placeholder="Paste CSR here..."></textarea><br />
<button id="decodeBtn">Decode CSR</button>

<h2>Decoded Information:</h2>
<pre id="decodedOutput">No data decoded yet.</pre>

<script>
document.getElementById('decodeBtn').addEventListener('click', () => {
  console.log('Decode button clicked');
  alert('Decode button clicked');

  const csrPEM = document.getElementById('csrInput').value.trim();
  const output = document.getElementById('decodedOutput');

  try {
    if(!csrPEM) {
      output.textContent = 'Please paste a CSR before decoding.';
      return;
    }

    const pemBody = csrPEM.replace(/-----BEGIN CERTIFICATE REQUEST-----/, '')
                          .replace(/-----END CERTIFICATE REQUEST-----/, '')
                          .replace(/\s+/g, '');
    if(!pemBody) {
      output.textContent = 'Invalid CSR format.';
      return;
    }

    const b64tohex = (b64) => {
      const raw = atob(b64);
      let result = '';
      for(let i=0; i<raw.length; i++) {
        let h = raw.charCodeAt(i).toString(16);
        if(h.length === 1) h = '0' + h;
        result += h;
      }
      return result;
    };
    const csrHex = b64tohex(pemBody);

    const csr = new KJUR.asn1.csr.CertificationRequest({hex: csrHex});
